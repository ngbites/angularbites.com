<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png"><link rel="icon" href="/assets/images/favicon.ico"><title>Writing scalable Typescript</title><meta name="description" content="Bite-sized resources for Angular and its ecosystem"><meta name="author" content="Giancarlo Buomprisco"><meta property="og:title" content="Writing scalable Typescript"><meta property="og:description" content="Bite-sized resources for Angular and its ecosystem"><meta property="og:locale" content="en"><meta property="og:site_name" content="Angular Bites"><link href="/assets/styles/main.5ba48212efe0114a022d.css" rel="stylesheet"></head><body><div class="container mx-auto pt-8"><header class="flex"><div><a href="/"><img width="58" height="58" alt="Logo" src="/assets/images/logo.png"></a></div><div class="ml-5"><h2 class="text-2xl"><a class="font-bold" href="/">Angular Bites</a></h2><h2 class="text-lg mb-8 text-gray-800">Bite-sized resources for Angular and its ecosystem</h2></div></header><article class="post pt-4"><header class="mb-6"><h1 class="text-5xl">Writing scalable Typescript</h1><div class="user-image mb-2 flex items-center"><a href="https://twitter.com/@gc_psk" class="flex items-center"><img src="/assets/images/giancarlo.jpeg"> <span class="ml-2 text-gray-600 text-sm">@gc_psk</span> </a><span class="text-gray-600 text-400 ml-1">/ April 5, 2019</span></div><div class="mt-8 mb-8"><a href="/tags/typescript" class="tag-item text-xs">typescript</a></div></header><section class="pb-3"><h4>Let‚Äôs explore in detail how to write clean, safe, enterprise-grade Typescript code</h4><p>Before we get started, I want to give my checklist for ‚Äúscalable code‚Äù; in the case of this article, Typescript code:</p><ul><li>it is clean, well-formatted, readable code</li><li>it is well-designed, consistent and predictable</li><li>it is easy to extend</li><li>last but not least, it is bug-free</li></ul><p>Since its introduction, Typescript has helped us solve some of the biggest problems with the Javascript ecosystem thanks to its tooling and its powerful static analysis.</p><p>In my experience, though, many teams <strong>only leverage a very small part</strong> of the features that Typescript provides us.</p><p>Some argue that:</p><ul><li>it is time-consuming</li><li>typing our code does not reduce its bugs</li><li>it‚Äôs harder and more difficult for junior developers to get started with</li></ul><p>And I am not here to prove them wrong. Cause thing is, they may be right.</p><p>But Typescript doesn‚Äôt have to be scary, and in my opinion, writing code using it properly largely outweighs the cons mentioned above.</p><p>In this article, I want to discuss and explore the best tooling and practices to <strong>make Typescript worth our time</strong>.</p><h2>Use Linters and Formatters</h2><p>As stated above, we want our Typescript code to be clean, well-formatted and readable.</p><p>In one <a href="https://medium.com/r/?url=https%3A%2F%2Fitnext.io%2Fenforce-your-team-coding-style-with-prettier-and-tslint-9faac5016ce7">of my previous articles</a>, I wrote a guide for setting up <em>Prettier</em> and <em>TsLint</em> in order to keep our code consistent for the whole team. As I may be repeating myself too often, I won‚Äôt go too much in detail in regards to why and how to set up these tools.</p><p>Instead, I want to focus on the impact of the benefits to your team from using these tools.</p><p>Whether you‚Äôre using EsLint, TsLint, Prettier or all of them, I can‚Äôt stress enough that providing consistency to our codebases is one of the most impactful things in terms of productivity for an efficient team.</p><p>A familiar codebase:</p><ul><li>is easier to read and work with</li><li>is easier to understand and get started with</li><li>is easier to modify</li><li>is easier to review</li><li>reduces frictions within a team</li></ul><p>And anyone who‚Äôs worked in this industry long enough knows far too well how important the last point is.</p><p>For a business, frictions, and misunderstandings among colleagues are worst than bad code and worse than bugs.</p><p>And programmers happen to care about formatting quite a lot.</p><p>By reducing to the minimum the amount of time spent arguing on code reviews, meetings, and calls, we make the business more efficient as a result.</p><p>The time spent reviewing where a semicolon is positioned is instead spent checking that the business logic of the code is correct, or that the performance of a function is optimal. That‚Äôs what a code review should be.</p><blockquote><p>A happy team is a team is an efficient one. Keep your Typescript clean with linters and formatters.</p></blockquote><h2>Use Strict Compiler¬†options</h2><p>One of Typescript‚Äôs biggest help comes from enabling its strict mode compiler. In order to enable strict mode, you just need to change the compiler options file located in your <code>tsconfig.json</code>:</p><pre><code>&quot;compilerOptions&quot;: {
    ... // more
    &quot;strict&quot;: true
}
</code></pre><p>By enabling this option, as a result of the other strict options will also be enabled by default.</p><h3>Strict Null¬†Checks</h3><p>A strict compiler will help us catch possible errors that may happen at runtime.</p><p><code>strictNullChecks</code> is, in my opinion, the most important option to make your compiler help you prevent such errors.</p><p>In conjunction with correct typing, this option will warn us when we are trying to access a possibly <code>null</code> or <code>undefined</code> value.</p><p>This is probably one of the most common causes of runtime errors in our applications, and we can finally get help to avoid them as much as possible.</p><p>If you have a been a Javascript developer for more than 2 hours before reading this article, you may have seen this in your console:</p><blockquote><p><em>Uncaught TypeError: Cannot read property ‚Äòproperty‚Äô of undefined</em></p></blockquote><p>Oh, I have. <strong>Thousands of times</strong>.</p><p>But‚Ä¶ not so much lately, thanks to Typescript.</p><p>So how exactly does <code>strictNullChecks</code> help us?</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*SuRzMd87h2lH9tqgyNKj_w.png" alt=""></p><p>Let‚Äôs break down this example:</p><ul><li>we have some boolean called <code>x</code></li><li>we have a declared function <code>logger</code></li><li>we want to call <code>logger</code> with a variable called <code>msg</code> that could also be undefined</li></ul><p>And the compiler is, rightly and gently, letting me know that if <code>logger</code> accepts an argument that I type as string, then I can only pass an argument that is only and always a string.</p><p>If I type logger‚Äôs <em>msg</em> argument as a string, then I cannot call String‚Äôs methods.</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*kQLu2mtugqhAWYJpM61JiQ.png" alt=""></p><p>These examples look as trivial and extremely simple, but it‚Äôs incredibly common to find similar situations in professional codebases.</p><p>The good thing is, <code>strictNullChecks</code> helps us in much more contrived scenarios.</p><h2>Type well, Type¬†often</h2><h3>Honest typing</h3><p>Some of you may be thinking if the term ‚Äúhonest‚Äù is due to my limited English skills or if there‚Äôs more to it. What‚Äôs honest typing?</p><ul><li>Say we have a back-end API that returns the price object of a financial product</li><li>Not all responses contain an <em>ask price</em> or a <em>bid price</em></li></ul><pre class="language-typescript"><code class="language-typescript"><span class="token punctuation">{</span><br>    <span class="token string">"correlationId"</span><span class="token operator">:</span> <span class="token string">"123"</span><span class="token punctuation">,</span><br>    <span class="token string">"askPrice"</span><span class="token operator">:</span> <span class="token number">1213.45</span><span class="token punctuation">,</span><br>    <span class="token string">"bidPrice"</span><span class="token operator">:</span> <span class="token keyword">undefined</span><br><span class="token punctuation">}</span></code></pre><p>Let‚Äôs create a Typescript interface for this:</p><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Price</span> <span class="token punctuation">{</span><br>    correlationId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>    askPrice<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><br>    bidPrice<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Is that correct? Certainly not.</p><p>I have heard several reasons why programmers won‚Äôt fully type nullable values:</p><blockquote><p>I‚Äôm lazy, the compiler will complain</p></blockquote><blockquote><p>98% of times it‚Äôs not undefined</p></blockquote><blockquote><p>‚ÄúI have no idea what that does‚Äú</p></blockquote><p>We want to tell the compiler that <code>askPrice</code> and <code>bidPrice</code> might be <code>undefined</code>. The compiler, as a result, will warn us when we‚Äôre trying to access these properties without checking the type or if they exist beforehand.</p><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">Price</span> <span class="token punctuation">{</span><br>    correlationId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>    askPrice<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><br>    bidPrice<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// or</span><br><br><span class="token keyword">interface</span> <span class="token class-name">Price</span> <span class="token punctuation">{</span><br>    correlationId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>    askPrice<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br>    bidPrice<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>That means <strong>the compiler helps us avoid runtime errors</strong> when that 2% of times do happen.</p><p>Honest typing also helps our new coworkers or users of our libraries to fully understand the domain entities of the application.</p><p>There‚Äôs literally no reason why your client-side entities shouldn‚Äôt fully and strictly be typed as their back-end counterparts.</p><h3>no implicit¬†any</h3><p>As we have seen in the previous paragraph, honest and rigorous typing plays a fundamental role in ensuring our code behaves in a correct way.</p><p>Honest typing is related to the option <em>noImplicitAny.</em></p><p>Let‚Äôs consider the following snippet:</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*q5cL6jF2ICpRbWkPKWhpFw.png" alt=""></p><p>The compiler has no idea what <code>x</code> and <code>y</code> are, and in some situations, it cannot figure it out on its own.</p><blockquote><p>Don‚Äôt be lazy, and <strong>type your¬†code</strong>.</p></blockquote><p>There are situations where the compiler can figure it out without us explicitly adding a type, but in these cases, you need to consider whether adding the type increases or decreases the readability of your code.</p><h2>Clean Typescript Code</h2><h3>Use predictable naming conventions</h3><p>While linters and formatters make great allies in ensuring consistency across our codebases, there are some things that they still cannot help with: naming.</p><p>Use predictable naming conventions your team can understand is fundamental in ensuring cleanliness, consistency, and clarity.</p><p>Consider the following snippet, which is a scenario I encounter far too often:</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*jAvSp7tyXSfZmhe_ZNzE-Q.png" alt=""></p><p>Obviously, <strong>I am not saying naming is easy</strong>. It‚Äôs not.</p><p>But if you follow the most basic principles, you‚Äôre still ahead of many. Some things I‚Äôd feel suggesting are:</p><ul><li>if your method does not return anything, never prefix it with <em>get</em></li><li>if your method returns something, never prefix it with <em>set</em></li><li>ideally, don‚Äôt set and get in the same method‚Ä¶</li><li>if your method is returning a boolean, consider prefixing it with <em>is</em> or <em>should (isThisThingVisible, shouldShowError, etc.)</em></li><li>don‚Äôt name your variables with their type</li><li>if you‚Äôre using a DSL from a different library or framework, stick with their conventions. For example, if you declare an observable with <em>RxJS</em>, make sure to suffix it with the dollar symbol ($)</li></ul><h3>Use Aliases</h3><p>Let‚Äôs be honest, no one likes seeing relative imports all over the place in our Typescript code. Using the paths aliases functionality in Typescript is a great way for making the imports nicer and shorter.</p><p>How do aliases work?</p><p>We define the <code>paths</code> configuration in our <code>tsconfig.json</code>¬†. See the below example:</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*_1zVUzTV4cmAwS_p8Ki9fw.png" alt=""></p><p>And then, I can access all my interfaces from <code>@core/interfaces</code> and (if you prefer even shorter access), all my enums from <code>enums.</code></p><p><img src="https://cdn-images-1.medium.com/max/1600/1*_VwO_1qoi2i1aoU0mTfaVw.png" alt=""></p><h3>Prefer horizontal reading</h3><p>This is someone not everyone may be on the same page with me, but that I greatly believe impacts the overall readability of your code.</p><p>I love to keep my lines code between 80 (perfect) and 120 lines of code, depending on how my team feels about it.</p><p>Let‚Äôs see the difference with one of my projects‚Äô snippets. In the following image, the horizontal length is set to 120.</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*HuZwRELp053NnZV_wWChEA.png" alt=""></p><p>In the image below, it is instead set to 80.</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*bAg9o5s4LXTRnYLE0zUnjw.png" alt=""></p><p>Which one would you say it is easier to read and modify?</p><blockquote><p>üí°<strong>Pro tip</strong>: Use Prettier to automatically wrap code for you</p></blockquote><h3>Arrow functions are cool but don‚Äôt overuse¬†them</h3><p>I love arrow-functions. And I use them pretty often too. But I see them abused from time to time.</p><p>Arrow functions are perfect for small expressions, but for longer and more complex ones, I‚Äôd much rather create a function block.</p><p>Sometimes I see pretty convoluted expressions just for the sake of using an arrow function.</p><p>Let‚Äôs see the difference between a long expression with an arrow function:</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*SX0FtvRe_HRsUAWcMTBs6g.png" alt=""></p><p>And without an arrow function:</p><p><img src="https://cdn-images-1.medium.com/max/1600/1*EzXx8gQCcuhglxaQl2vAbQ.png" alt=""></p><p>It is totally possible to still use an arrow function and wrap the expression on the next line, but I feel it adds complexity when I happen to refactor the code, for example, if I need to add a variable in the expression.</p><p>If you wrap it with an arrow function which is perfectly fine, make sure that the piece of code is unlikely to be changed anytime soon.</p><h3>Use logical¬†spacing</h3><p>Just like in Medium, white space, although not too much, can impact readability.</p><p>The same happens with our code: we want to add spacing where it makes sense.</p><p>Some code just feels like a wall of text without any logical separation. This is not an easy task, as everyone might just feel different about it, and a lot of it probably depends on everyone‚Äôs preferences.</p><p>I‚Äôd say there are two main reasons for adding spaces:</p><ul><li>logical reasons, as it concerns the logic behind our code</li><li>design reasons, as it concerns how easy the code is to read</li></ul><p>I won‚Äôt talk about the design reasons behind it as this just feels too subjective. Personally, I just try to follow these simple guidelines:</p><ul><li>group variables declarations logically</li><li>keep one white space between your return statement and the function body</li></ul><p>If we are building two different objects with two separate groups of constants, chances are we want to add a space between them. For example:</p><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">".."</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> surname <span class="token operator">=</span> <span class="token string">".."</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> player <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> surname <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token comment">// logical break</span><br><span class="token keyword">const</span> teamName <span class="token operator">=</span> <span class="token string">".."</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> teamId <span class="token operator">=</span> <span class="token string">".."</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> team <span class="token operator">=</span> <span class="token punctuation">{</span> teamName<span class="token punctuation">,</span> teamId <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">return</span> <span class="token punctuation">{</span> player<span class="token punctuation">,</span> team <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3>Break complex expressions down</h3><p>It is pretty easy to end up with various long and complex expressions in our code.</p><p>I‚Äòd recommend to break down long expressions into groups of variables and separate methods.</p><ul><li>If a condition has more than 2 or 3 expressions, you should consider to break it down</li><li>if a condition contains magic strings and numbers, you should consider extracting the expression into a method</li></ul><p>Let‚Äôs see a scenario where we have two possibly undefined objects that I am sure you see every day:</p><pre class="language-typescript"><code class="language-typescript"><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>price <span class="token operator">&amp;&amp;</span> price<span class="token punctuation">.</span>canExecute <span class="token operator">&amp;&amp;</span> user <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>hasPermissions <span class="token operator">&amp;&amp;</span> service<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> priceService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>Maybe it‚Äôs my poor sight, but I can‚Äôt read that! Let‚Äôs refactor this:</p><pre class="language-typescript"><code class="language-typescript"><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> <span class="token constant">STATUS_CODE_UP</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> isServiceDown <span class="token operator">=</span> service<span class="token punctuation">.</span>status <span class="token operator">!==</span> <span class="token constant">STATUS_CODE_UP</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>isServiceDown<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>price<span class="token punctuation">.</span>canExecute <span class="token operator">||</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>hasPermissions<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">return</span> priceService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Ok, I can read this, but now just feels too long. Let‚Äôs refactor again:</p><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">const</span> <span class="token constant">STATUS_CODE_UP</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// ideally imported from another file</span><br><br><span class="token keyword">get</span> <span class="token function">isServiceUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> service<span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token constant">STATUS_CODE_UP</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">get</span> <span class="token function">canExecute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>price <span class="token operator">||</span> <span class="token operator">!</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">return</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token keyword">return</span> price<span class="token punctuation">.</span>canExecute <span class="token operator">&amp;&amp;</span> user<span class="token punctuation">.</span>hasPermissions<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>   <span class="token keyword">const</span> canExecute <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>isServiceUp <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>canExecute<span class="token punctuation">;</span><br>   <span class="token keyword">return</span> canExecute <span class="token operator">&amp;&amp;</span> priceService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>That feels better!</p><h2>Takeaways</h2><ul><li>Lint and Format your code before it gets pushed</li><li>Be rigorous with your code, enable <code>strict</code> mode</li><li>Type well, and type often. Don‚Äôt use <em>any,</em> use generics and <em>unknown</em> instead</li><li>Make sure your code is as readable as possible by following industry standards</li></ul></section><div class="text-sm">Do you want to report something incorrect? Please open an Issue or a PR on <a class="underline" href="https://github.com/Gbuomprisco/angularbites.com">Github</a></div><footer class="mt-5 pb-5 mb-10"><a class="underline" href="/">Back to home</a></footer></article></div><script async src="https://www.googletagmanager.com/gtag/js?id=UA-172483071-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-172483071-1")</script><script src="https://zedform-sdk.web.app/tracking-sdk.umd.js"></script><script src="https://zedform-sdk.web.app/sdk.umd.js" async data-formtoro></script><div data-formtoro-form="10844c24-0314-4c31-8272-9e00dafdd0ec"></div><link href="https://fonts.googleapis.com/css2?family=Martel:wght@400;700;800&display=swap" rel="stylesheet"></body></html>